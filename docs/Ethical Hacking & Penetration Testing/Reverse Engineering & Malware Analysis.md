# üîç Reverse Engineering & Malware Analysis Cheatsheet

## üîπ Introduction
Reverse engineering and malware analysis involve **dissecting software or malware** to understand its functionality, vulnerabilities, and potential threats.

---

## üîπ Types of Reverse Engineering
| Type | Description |
|------|-------------|
| **Static Analysis** | Examining binaries without executing them |
| **Dynamic Analysis** | Running and monitoring behavior in a controlled environment |
| **Reverse Code Engineering (RCE)** | Decompiling and analyzing source code |
| **Protocol Reverse Engineering** | Analyzing network communication protocols |

---

## üîπ Static Analysis
### ‚úÖ Extracting File Metadata
```sh
file malware.exe  # Identify file type
strings malware.exe | less  # Extract readable strings
sha256sum malware.exe  # Generate hash for integrity check
```

### ‚úÖ Disassembly & Decompilation
- **Disassemblers:** IDA Pro, Ghidra, Radare2
- **Decompiler for Windows:** RetDec, Hex-Rays
- **Decompiler for Java:** JD-GUI, JADX

```sh
r2 -A malware.exe  # Analyze binary with Radare2
```

---

## üîπ Dynamic Analysis
### ‚úÖ Setting Up a Safe Sandbox
- **Virtual Machine (VM)**: Use **VMware or VirtualBox** with **Kali Linux or REMnux**
- **Malware Sandboxing**: Cuckoo Sandbox, Any.Run
- **Process Monitoring**: Process Hacker, ProcMon

### ‚úÖ Monitoring Execution Behavior
```sh
strace -f -e trace=network malware.bin  # Trace network calls
ltrace malware.bin  # Trace library function calls
```

### ‚úÖ Detecting Registry & File System Changes
```sh
regshot -c  # Compare Windows registry before/after execution
procmon.exe  # Monitor process activities in Windows
```

---

## üîπ Network Traffic Analysis
### ‚úÖ Capture Network Traffic with Wireshark
```sh
tshark -i eth0 -w traffic.pcap  # Capture network traffic
```

### ‚úÖ Analyze Traffic
- Filter for HTTP requests:
  ```sh
  http.request.method == "GET"
  ```
- Filter for DNS queries:
  ```sh
  dns.qry.name contains "example.com"
  ```

---

## üîπ Debugging Malware
### ‚úÖ Debugging with GDB (Linux)
```sh
gdb malware.bin
break main  # Set a breakpoint at main
run  # Execute malware
```

### ‚úÖ Debugging with OllyDbg/x64dbg (Windows)
- Set breakpoints on API calls.
- Monitor register and memory modifications.
- Track execution flow.

---

## üîπ Common Obfuscation & Evasion Techniques
| Technique | Purpose |
|-----------|---------|
| **Packing** | Compresses binary to evade detection |
| **Code Obfuscation** | Hides malicious intent in code |
| **Environment Checks** | Detects if running in VM or debugger |
| **Polymorphic Malware** | Modifies code to avoid signature detection |

### ‚úÖ Unpacking Packed Binaries
```sh
upx -d malware_packed.exe  # Attempt to unpack UPX-packed binary
```

---

## üîπ Best Practices
- **Use a dedicated isolated environment** for malware analysis.
- **Never run malware on a production machine.**
- **Cross-check findings with multiple tools** (e.g., VirusTotal, Hybrid Analysis).
- **Document all findings** for future reference.

---